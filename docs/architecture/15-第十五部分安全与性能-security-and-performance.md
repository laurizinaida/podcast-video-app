## **第十五部分：安全与性能 (Security and Performance)**

### **安全要求 (Security Requirements)**

**前端安全:**

* 配置严格的**内容安全策略 (CSP)**
* 所有用户生成的内容在渲染时都必须经过严格的净化处理
* 认证状态通过HttpOnly Cookie管理，前端无法直接访问token

**认证安全:**

* 使用安全的、`HttpOnly`的会话Cookie
* 所有密钥**必须**通过环境变量管理，严禁硬编码

**强制性规定：**

* **密码哈希必须且只能在后端执行。** 在处理用户注册（`apps/web/src/app/api/auth/register`）的API路由中，接收到用户的明文密码后，**必须立即**使用`bcrypt`进行哈希，然后才能将哈希后的值存入数据库。**严禁**在前端对密码进行任何形式的哈希处理。

### **性能优化 (Performance Optimization)**

**前端性能:**

* 采用**代码分割**、**懒加载**策略
* 充分利用Cloudflare Pages的全球**CDN缓存**

**后端性能:**

* API的目标响应时间（P95）应在**200毫秒**以内
* 数据库查询**必须**使用索引

***
